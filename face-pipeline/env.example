# Face Pipeline Environment Configuration

# MinIO
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_SECURE=false
MINIO_BUCKET_RAW=raw-images
MINIO_BUCKET_CROPS=face-crops
MINIO_BUCKET_THUMBS=thumbnails
MINIO_BUCKET_METADATA=face-metadata
PRESIGN_TTL_SEC=600

# Qdrant
QDRANT_URL=http://localhost:6333
# QDRANT_API_KEY=
QDRANT_COLLECTION=faces_v1
IDENTITY_COLLECTION=identities_v1
VECTOR_DIM=512
SIMILARITY_THRESHOLD=0.6

# Verification-First Flow (Recommended Settings)
# See VERIFICATION_FLOW_GUIDE.md for detailed recommendations
VERIFY_HI_THRESHOLD=0.78
VERIFY_TOP_K=50
VERIFY_HNSW_EF=128

# Redis Configuration
REDIS_URL=redis://localhost:6379/0
REDIS_STREAM_NAME=face-processing-queue
REDIS_GROUP_NAME=pipeline
REDIS_CONSUMER_NAME=pipe-1
# Legacy aliases (backward compatible):
# FACE_STREAM=face-processing-queue
# FACE_GROUP=pipeline
# FACE_CONSUMER=pipe-1

# Feature Flags
ENABLE_GLOBAL_DEDUP=true
ENABLE_QUEUE_WORKER=false

# Worker Configuration
MAX_WORKER_CONCURRENCY=5
WORKER_BATCH_SIZE=10

# Deduplication Configuration (Primary names used by code)
DEDUP_TTL_SECONDS=3600
DEDUP_MAX_HAMMING=8

# Accepted aliases for backward compatibility (optional)
# GLOBAL_DEDUP_ENABLED=true
# GLOBAL_DEDUP_TTL_SEC=3600
# GLOBAL_DEDUP_MAX_HAMMING=8

# Face Detection & Quality
DET_SIZE=640,640
DET_SCORE_THRESH=0.45
ONNX_PROVIDERS_CSV=CPUExecutionProvider
IMAGE_SIZE=112
MIN_FACE_SIZE=80
BLUR_MIN_VARIANCE=120.0
MIN_OVERALL_QUALITY=0.7

# API Configuration
API_HOST=0.0.0.0
API_PORT=8001
API_RELOAD=false
LOG_LEVEL=INFO
CORS_ORIGINS=*

# Pipeline Settings
MAX_FACES_PER_IMAGE=10
ENABLE_DEDUPLICATION=true
MAX_CONCURRENT=5

