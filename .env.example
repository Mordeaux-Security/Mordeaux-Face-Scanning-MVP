# Mordeaux Face Scanning MVP - Environment Configuration
# Copy this file to .env and fill in your values

# ============================================================================
# General
# ============================================================================
ENVIRONMENT=development
TZ=America/Los_Angeles
LOG_LEVEL=info

# ============================================================================
# Database - PostgreSQL
# ============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=mordeaux
POSTGRES_USER=mordeaux
POSTGRES_PASSWORD=changeme

# ============================================================================
# Cache & Queue - Redis
# ============================================================================
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2

# ============================================================================
# Object Storage - MinIO/S3
# ============================================================================
# Note: docker-compose uses S3_* prefix for compatibility
# Face-pipeline uses MINIO_* prefix for clarity
# Both point to the same MinIO instance

# For docker-compose services (legacy naming)
S3_ENDPOINT=http://minio:9000
S3_REGION=us-east-1
S3_ACCESS_KEY=changeme
S3_SECRET_KEY=changeme
S3_USE_SSL=false
S3_BUCKET_RAW=raw-images
S3_BUCKET_THUMBS=thumbnails
S3_BUCKET_AUDIT=audit-logs

# For face-pipeline services (preferred naming)
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=changeme
MINIO_SECRET_KEY=changeme
MINIO_SECURE=false
MINIO_BUCKET_RAW=raw-images
MINIO_BUCKET_CROPS=face-crops
MINIO_BUCKET_THUMBS=thumbnails
MINIO_BUCKET_METADATA=face-metadata

# ============================================================================
# Vector Database - Qdrant
# ============================================================================
QDRANT_URL=http://localhost:6333
QDRANT_COLLECTION=faces_v1
VECTOR_INDEX=faces_v1

# ============================================================================
# Alternative Vector DB - Pinecone (optional)
# ============================================================================
PINECONE_API_KEY=
PINECONE_INDEX=faces_v1

# ============================================================================
# Face Pipeline Configuration
# ============================================================================
MAX_CONCURRENT=4
JOB_TIMEOUT_SEC=300
FACE_MIN_SIZE=80
BLUR_MIN_VARIANCE=120.0
PRESIGN_TTL_SEC=600

# Face Detection & Embedding
DETECTOR_MODEL=buffalo_l
DETECTOR_CTX_ID=-1
DETECTOR_SIZE_WIDTH=640
DETECTOR_SIZE_HEIGHT=640
EMBEDDING_DIM=512
NORMALIZE_EMBEDDINGS=true

# Quality Thresholds
MIN_FACE_QUALITY=0.5
MIN_SHARPNESS=100.0
MIN_BRIGHTNESS=30.0
MAX_BRIGHTNESS=225.0
MAX_POSE_ANGLE=45.0
MIN_OVERALL_QUALITY=0.7
MAX_FACES_PER_IMAGE=10

# ============================================================================
# Backend API
# ============================================================================
ASGI_WORKERS=2
API_HOST=0.0.0.0
API_PORT=8000

# ============================================================================
# Frontend
# ============================================================================
VITE_API_BASE=http://localhost:8000

# ============================================================================
# Nginx
# ============================================================================
NGINX_MAX_BODY=50m
